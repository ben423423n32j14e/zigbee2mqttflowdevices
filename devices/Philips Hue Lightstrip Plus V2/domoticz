Domoticz Virtual Device Type: RGBWW Switch

[{"id":"8bf1080c.57bc48","type":"comment","z":"f962b96d.7044c8","name":"Hue Lightstrip","info":"","x":110,"y":520,"wires":[]},{"id":"f86a294b.4f2478","type":"mqtt in","z":"f962b96d.7044c8","name":"","topic":"domoticz/out","qos":"2","broker":"cd51966f.aa7e38","x":270,"y":520,"wires":[["867a3c85.c0eaf"]]},{"id":"dcc919de.4c3e28","type":"function","z":"f962b96d.7044c8","name":"Format Data","func":"var idx = msg.payload.idx;\n\nif (idx == '1258' && typeof idx !== 'undefined' && idx !== null){\n\nvar nvalue = msg.payload.nvalue;\nvar brightness = msg.payload.svalue1;\nvar r = msg.payload.Color.r;\nvar g = msg.payload.Color.g;\nvar b = msg.payload.Color.b;\nvar colortemp = msg.payload.Color.ww;\nmsg.payload = {}\n\n\nif(nvalue == '0') {\n    msg.payload.state = 'OFF'\n}\nif(nvalue == '1') {\n    msg.payload.state = 'ON';\n    msg.payload.brightness = Math.round(brightness * 255 / 100);\n    if (r === 0 && b === 0 && g === 0) {\n    msg.payload.color_temp = Math.round(500 / 255 * colortemp);\n    msg.payload.transition = 1.5;\n    }else{\n    msg.payload.color = {\"r\":r,\"g\":g,\"b\":b};\n    msg.payload.transition = 1.5;\n}\n}\n\nreturn msg;\n}","outputs":1,"noerr":0,"x":550,"y":520,"wires":[["b2380e0a.0a515"]]},{"id":"867a3c85.c0eaf","type":"json","z":"f962b96d.7044c8","name":"","property":"payload","action":"","pretty":false,"x":410,"y":520,"wires":[["dcc919de.4c3e28"]]},{"id":"b2380e0a.0a515","type":"mqtt out","z":"f962b96d.7044c8","name":"zigbee2mqtt/in","topic":"zigbee2mqtt/huetest/set","qos":"","retain":"","broker":"cd51966f.aa7e38","x":720,"y":520,"wires":[]},{"id":"cd51966f.aa7e38","type":"mqtt-broker","z":"","name":"MQTT","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""}]
